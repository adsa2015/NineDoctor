(function(){var e;e=window.jQuery||window.Zepto||window.$,e.fn.fancySelect=function(n){var t,i;return null==n&&(n={}),i=e.extend({forceiOS:!1,includeBlank:!1},n),t=!!navigator.userAgent.match(/iP(hone|od|ad)/i),this.each(function(){var n,o,r,a,s,l,d;return a=e(this),a.hasClass("fancified")||"SELECT"!==a[0].tagName?void 0:(a.addClass("fancified"),a.css({width:1,height:1,display:"block",position:"absolute",top:0,left:0,opacity:0}),a.wrap('<div class="fancy-select">'),d=a.parent(),a.data("class")&&d.addClass(a.data("class")),d.append('<div class="trigger">'),(!t||i.forceiOS)&&d.append('<ul class="options">'),s=d.find(".trigger"),r=d.find(".options"),o=a.prop("disabled"),o&&d.addClass("disabled"),l=function(){return s.text(a.find(":selected").text())},a.on("blur",function(){return s.hasClass("open")?setTimeout(function(){return s.trigger("close")},120):void 0}),s.on("close",function(){return s.removeClass("open"),r.removeClass("open")}),s.on("click",function(){var n,l;if(!o)if(s.toggleClass("open"),t&&!i.forceiOS){if(s.hasClass("open"))return a.focus()}else if(s.hasClass("open")&&(l=s.parent(),n=l.offsetParent(),l.offset().top+l.outerHeight()+r.outerHeight()+20>e(window).height()+e(window).scrollTop()?r.addClass("overflowing"):r.removeClass("overflowing")),r.toggleClass("open"),!t)return a.focus()}),a.on("enable",function(){return a.prop("disabled",!1),d.removeClass("disabled"),o=!1,n()}),a.on("disable",function(){return a.prop("disabled",!0),d.addClass("disabled"),o=!0}),a.on("change",function(e){return e.originalEvent&&e.originalEvent.isTrusted?e.stopPropagation():l()}),a.on("keydown",function(e){var n,t,i;if(i=e.which,n=r.find(".hover"),n.removeClass("hover"),r.hasClass("open")){if(38===i?(e.preventDefault(),n.length&&n.index()>0?n.prev().addClass("hover"):r.find("li:last-child").addClass("hover")):40===i?(e.preventDefault(),n.length&&n.index()<r.find("li").length-1?n.next().addClass("hover"):r.find("li:first-child").addClass("hover")):27===i?(e.preventDefault(),s.trigger("click")):13===i||32===i?(e.preventDefault(),n.trigger("click")):9===i&&s.hasClass("open")&&s.trigger("close"),t=r.find(".hover"),t.length)return r.scrollTop(0),r.scrollTop(t.position().top-12)}else if(13===i||32===i||38===i||40===i)return e.preventDefault(),s.trigger("click")}),r.on("click","li",function(n){return a.val(e(this).data("value")),t||a.trigger("blur").trigger("focus"),r.find(".selected").removeClass("selected"),e(n.currentTarget).addClass("selected"),a.val(e(this).data("value")).trigger("change").trigger("blur").trigger("focus")}),r.on("mouseenter","li",function(){var n,t;return t=e(this),n=r.find(".hover"),n.removeClass("hover"),t.addClass("hover")}),r.on("mouseleave","li",function(){return r.find(".hover").removeClass("hover")}),n=function(){var n;return l(),!t||i.forceiOS?(n=a.find("option"),a.find("option").each(function(n,t){return t=e(t),t.prop("disabled")||!t.val()&&!i.includeBlank?void 0:t.prop("selected")?r.append('<li data-value="'+t.val()+'" class="selected">'+t.text()+"</li>"):r.append('<li data-value="'+t.val()+'">'+t.text()+"</li>")})):void 0},a.on("update",function(){return d.find(".options").empty(),n()}),n())})}}).call(this);